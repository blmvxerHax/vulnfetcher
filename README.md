# Vulnfetcher
A rudimentary vulnerability scanner for installed debian packages. It checks a filelist (generated by 'dpkg -l > file') against known vulnerabilities, by searching websites and scoring the results.

> ![Vulnfetcher Demo](/demo/vulnfetcher-optimized.gif)

## Word of caution: 
This tool webscrapes google, which is against their policies. This tool does it with a fairly big pause in between searches, but still: using this tool might might ban you (temporarily) from google. Obviously this is written for conceptual reasons and I do not endorse that you use it, nor do I take responsibility if you do.

## Expectations
This tool is released as a conceptual idea and proof of concept. It's 'use as is': 
I am not a coder, I just thought this would help me in my work. Unless someone picks this idea up, bugreports and feauture requests will probably stay unanswered.

If any real coder would like to contribute to this: by all means, please do!

## Install dependencies
```
pip3 install requests
pip3 install beautifulsoup4
pip3 install lxml
```
## Install
```
cd /opt
git clone https://github.com/gnothiseautonlw/vulnfetcher.git
```
## Usage
```
dpkg -l > file
python3 vulnfetcher.py file
```
## Output
Appart from the onscreen report while scanning and afterwards, the tool writes two files in the same folder as the input file:
* file.vulnfetcher.json
   * A sorted json file, containing all information the tool found and that it used to score the findings
* file.vulnfetcher.report
   * A sorted textfile containing the report that's printed on screen after the search is done

## Help
```
python3 vulnfetcher.py -h
```
## How it works
Parsing:
* It takes the input file, tries to make sense of the module names and module version numbers
* For the search term, it takes the 'mayor' - 'dot' - 'first number of minor'. So "libpam-modules 1.15.2", becomes "1.1"
* Then goes out on the web, looking with the search term: '"module_name"+"module_version"+exploit'. So in our example, it will look for '"libpam-modules"+"1.1"+"exploit"'
Scoring:
* For each trusted site that returns a result, it get's one point.
* If an exact match for the complete version number is found, it get's two points. So in our example if '1.15.2' would be found, this get's two points
* If an exact cve-number is found, the details of that cve are fetched. If those details contain indications of a severe vulnerability, then 3 points are attibuted to that

## Suggested Development Roadmap
If a coder would like to pick this up, here's a suggested roadmap:
* Have some solution for the google restrictions
   * Currently the search is slowed down bigtime (the program waits 5 secdons in between each search), since google doesn't allow crawling their results. Having some solution for this would be great.
   * Maybe a non-profit google-api-key?
* Adding a progress bar when searching.
   * It would allow to display only results with a higher score and keep the output more condenced when the search is running
* Support for other input formats
* Improving the scoring algorithm 
   * could be improved by doing more testing
* Make code more beautiful.
   * I actually learned python to write this program, so I expect the code can be improved a lot
